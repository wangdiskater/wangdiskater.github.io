<!DOCTYPE html>





<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.3.8">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">

<link rel="stylesheet" href="//fonts.proxy.ustclug.org/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="0302如何从XML请求体获取参数接受请求的类型使用consumes 发送才是produces  @Post(value = “/scan”,consumes = MediaType.APPLICATION_XML)  HttpResponse getScan(@Body String json) {      QRCodeXML objectFromXML = (QRCodeXML)Util.g">
<meta property="og:type" content="article">
<meta property="og:title" content="0302-0306总结">
<meta property="og:url" content="http://yoursite.com/2020/05/03/0302-0306/index.html">
<meta property="og:site_name" content="路要坚持">
<meta property="og:description" content="0302如何从XML请求体获取参数接受请求的类型使用consumes 发送才是produces  @Post(value = “/scan”,consumes = MediaType.APPLICATION_XML)  HttpResponse getScan(@Body String json) {      QRCodeXML objectFromXML = (QRCodeXML)Util.g">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-05-03T07:20:04.743Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="0302-0306总结">
<meta name="twitter:description" content="0302如何从XML请求体获取参数接受请求的类型使用consumes 发送才是produces  @Post(value = “/scan”,consumes = MediaType.APPLICATION_XML)  HttpResponse getScan(@Body String json) {      QRCodeXML objectFromXML = (QRCodeXML)Util.g">
  <link rel="canonical" href="http://yoursite.com/2020/05/03/0302-0306/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>0302-0306总结 | 路要坚持</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">路要坚持</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/03/0302-0306/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王邸">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/head.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="路要坚持">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">0302-0306总结

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-05-03 12:07:21 / 修改时间：15:20:04" itemprop="dateCreated datePublished" datetime="2020-05-03T12:07:21+08:00">2020-05-03</time>
            </span>
          
            

            
          

          
            <span id="/2020/05/03/0302-0306/" class="post-meta-item leancloud_visitors" data-flag-title="0302-0306总结" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/05/03/0302-0306/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2020/05/03/0302-0306/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="0302"><a href="#0302" class="headerlink" title="0302"></a>0302</h1><p>如何从XML请求体获取参数<br>接受请求的类型使用consumes 发送才是produces</p><p>  @Post(value = “/scan”,consumes = MediaType.APPLICATION_XML)<br>  HttpResponse getScan(@Body String json) {<br>      QRCodeXML objectFromXML = (QRCodeXML)Util.getObjectFromXML(json, QRCodeXML.class);<br>      return RespUtils.SUCCESS(objectFromXML);<br>  }</p><a id="more"></a>

<h1 id="0303"><a href="#0303" class="headerlink" title="0303"></a>0303</h1><h3 id="1-mysql-批量修改一个字段"><a href="#1-mysql-批量修改一个字段" class="headerlink" title="1.mysql 批量修改一个字段"></a>1.mysql 批量修改一个字段</h3><p>update student set score=score+1 where id = 1</p>
<h3 id="2-数据库数据问题。"><a href="#2-数据库数据问题。" class="headerlink" title="2.数据库数据问题。"></a>2.数据库数据问题。</h3><p>总结：</p>
<p>  1.数据库表单名称修改导致之前的表单，结果全部都有问题。这是我的问题，应该确认是否已经上线。而不是直接把数据修改到正式。所有的数据库的数据表单更新全部都应该流程化。<br>  数据库更新应该从测试开始，而且为了方便管理尽量使用增量的形式进行修改。<br>  2.数据库更新，需要有更新的记录版本管理(在尝试寻找数据库记录版本管理)</p>
<h3 id="3-xshell-连接redis"><a href="#3-xshell-连接redis" class="headerlink" title="3.xshell 连接redis"></a>3.xshell 连接redis</h3><p>  连接内网redis<br>  url     : redis://YaeherMemdb0@172.16.32.3<br>  内网ip  ：172.16.32.3<br>  密码    ：YaeherMemdb0</p>
<h3 id="4-redis"><a href="#4-redis" class="headerlink" title="4.redis"></a>4.redis</h3><p>linux查看redis安装目录（只能在服务起起来查看）<br><a href="https://www.cnblogs.com/yangzailu/p/11044904.html" target="_blank" rel="external">https://www.cnblogs.com/yangzailu/p/11044904.html</a></p>
<p>  ps -ef|grep redis<br>拿到redis的进程号（注意是服务启动的进程号）</p>
<p>  ls -l /proc/xxxx/cwd</p>
<p>Redis (error) NOAUTH Authentication required 需要输入密码 auth + 密码</p>
<p>  *：通配任意多个字符<br>  ?：通配单个字符<br>  []：通配括号内的某一个字符</p>
<p>keys <em><br>get strkey.</em></p>
<h1 id="0304"><a href="#0304" class="headerlink" title="0304"></a>0304</h1><h2 id="idea问题"><a href="#idea问题" class="headerlink" title="idea问题:"></a>idea问题:</h2><p>ERROR -      #org.jetbrains.idea.maven - nul<br>mavene和idea不兼容<br>需要把maven换到3.6以下</p>
<p>旧版本maven下载：<br><a href="https://archive.apache.org/dist/maven/maven-3/" target="_blank" rel="external">下载</a></p>
<h2 id="数据库迁移"><a href="#数据库迁移" class="headerlink" title="数据库迁移"></a>数据库迁移</h2><h3 id="flyway-DataBaseMigration初体验"><a href="#flyway-DataBaseMigration初体验" class="headerlink" title="flyway DataBaseMigration初体验"></a>flyway DataBaseMigration初体验</h3><h3 id="问题：配置了阿里云镜像还是从国外服务器下载"><a href="#问题：配置了阿里云镜像还是从国外服务器下载" class="headerlink" title="问题：配置了阿里云镜像还是从国外服务器下载"></a>问题：配置了阿里云镜像还是从国外服务器下载</h3><p>需要把项目中的pom.xml中的Repositories给注释掉<br><!--    <repositories>--><br><!--        <repository>--><br><!--            <id>jcenter.bintray.com</id>--><br><!--            <url>https://jcenter.bintray.com</url>--><br><!--        </repository>--><br><!--    </repositories>--></p>
<h3 id="flyway配置数据源mysql"><a href="#flyway配置数据源mysql" class="headerlink" title="flyway配置数据源mysql"></a>flyway配置数据源mysql</h3><p>flyway upgrade recommended: MySQL 8.0 is newer than this version of Flyway an<br>说明flyway版本太低不支持mysql8<br>更新新版本flyway就好了<br>简单案例：</p>
<p>  <a href="https://www.cnblogs.com/moonlightL/p/10576844.html#autoid-0-2-0" target="_blank" rel="external">https://www.cnblogs.com/moonlightL/p/10576844.html#autoid-0-2-0</a><br>快速上手：</p>
<p>  <a href="https://www.jianshu.com/p/567a8a161641" target="_blank" rel="external">https://www.jianshu.com/p/567a8a161641</a></p>
<h3 id="flyway发现注入有问题"><a href="#flyway发现注入有问题" class="headerlink" title="flyway发现注入有问题"></a>flyway发现注入有问题</h3><p>解答：导入micronaut，项目运行之后自动执行了<br>这些数据库版本迁移工具本来就是以命令为主，而不是在代码中使用的。所以可能对代码支持不太好</p>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p>社区版flyway不支持回滚</p>
<h2 id="Liquibase-batabaseMigration"><a href="#Liquibase-batabaseMigration" class="headerlink" title="Liquibase batabaseMigration"></a>Liquibase batabaseMigration</h2><p>所以来使用一下这个</p>
<p>问题1：命令行好像不能liquibase执行回滚<br>难道不付费不能回滚吗？官网显示可以回滚<br>Liquibase Community</p>
<p>Track, version and deploy database changes<br>Rollbacks<br>Design changes in the format you want (SQL, XML, YAML and JSON)<br>Automatically generate database-appropriate SQL<br>Active user community and forum<br>可以回滚</p>
<p>问题2：不能在xml里面进行回滚？<br>不能再项目中回滚，需要通过命令行回滚，而xml可以回滚，但是必须是命令行执行liqubase的命令</p>
<h2 id="powerdesigner数据库设计软件"><a href="#powerdesigner数据库设计软件" class="headerlink" title="powerdesigner数据库设计软件"></a>powerdesigner数据库设计软件</h2><p>顾名思义，这是一个数据库设计的工具。这里有简单的使用<br>创建物理模型还是概念模型。然后可以把物理模型转成sql语句，更多功能等待挖掘。<br><a href="https://blog.csdn.net/idomyway/article/details/78658931" target="_blank" rel="external">https://blog.csdn.net/idomyway/article/details/78658931</a></p>
<h2 id="BUG"><a href="#BUG" class="headerlink" title="BUG"></a>BUG</h2><p>1.yaeheruser<br>一个用户对应两个角色<br>只考虑其一，没有考虑其二。认为可能会有一个电话在数据库有两条数据的可能，但是同时也有可能，这两条数据是有不同的功能，并不是一棒打死就是脏数据，需要再进一步的去查看，测试就出现的问题，以为是脏数据就删掉了。其实不然。</p>
<h1 id="0305"><a href="#0305" class="headerlink" title="0305"></a>0305</h1><h2 id="1-libphonenumber"><a href="#1-libphonenumber" class="headerlink" title="1.libphonenumber"></a>1.libphonenumber</h2><p>校验国际电话号码依赖<br><a href="https://github.com/google/libphonenumber" target="_blank" rel="external">https://github.com/google/libphonenumber</a><br><a href="https://blog.csdn.net/suyimin2010/article/details/82915918" target="_blank" rel="external">https://blog.csdn.net/suyimin2010/article/details/82915918</a></p>
<p>  /**</p>
<pre><code>* 根据区号判断是否是正确的电话号码
* @param phoneNumber :带国家码的电话号码
* @param countryCode :默认国家码
* return ：true 合法  false：不合法
*/
</code></pre><p>  public static boolean isPhoneNumberValid(String phoneNumber, String countryCode){</p>
<pre><code>System.out.println(&quot;isPhoneNumberValid: &quot;+phoneNumber+&quot;/&quot;+countryCode);
PhoneNumberUtil phoneUtil = PhoneNumberUtil.getInstance();
try{
    Phonenumber.PhoneNumber numberProto = phoneUtil.parse(phoneNumber, countryCode);
    return phoneUtil.isValidNumber(numberProto);
}catch (NumberParseException e){
    System.err.println(&quot;isPhoneNumberValid NumberParseException was thrown: &quot; + e.toString());
}
return false;
</code></pre><p>  }<br>测试</p>
<p>  boolean valid_cn = AndroidConfig.isPhoneNumberValid(“+8615820799999”,”86”);<br>  System.out.println(“isPhoneNumberValid:”+valid_cn);</p>
<p>  boolean valid_hk = AndroidConfig.isPhoneNumberValid(“+85283079901”,”852”);<br>  System.out.println(“isPhoneNumberValid:”+valid_hk);</p>
<h2 id="2-电话区号表"><a href="#2-电话区号表" class="headerlink" title="2.电话区号表"></a>2.电话区号表</h2><p><a href="http://www.51zzl.com/rcsh/gjqh.asp" target="_blank" rel="external">http://www.51zzl.com/rcsh/gjqh.asp</a></p>
<h2 id="3-idea在Terminal中使用maven指令"><a href="#3-idea在Terminal中使用maven指令" class="headerlink" title="3.idea在Terminal中使用maven指令"></a>3.idea在Terminal中使用maven指令</h2><p><a href="https://www.cnblogs.com/xk920/p/10669505.html" target="_blank" rel="external">https://www.cnblogs.com/xk920/p/10669505.html</a><br>其实就是在<strong>用户变量(环境变量上面那个)</strong>中加path 是maven的bin路径</p>
<h2 id="4-jwt的密钥在Java里面加-0-0-0-0无效，凑够16位"><a href="#4-jwt的密钥在Java里面加-0-0-0-0无效，凑够16位" class="headerlink" title="4.jwt的密钥在Java里面加/0/0/0/0无效，凑够16位"></a>4.jwt的密钥在Java里面加/0/0/0/0无效，凑够16位</h2><h2 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h2><p>1.今日踩坑之window、Mac上CSV（UTF-8编码）用Excel打开乱码<br>2.海外医生登录可能出现的问题？</p>
<p>  1.医生不在user和doctor表中，验证流程要改<br>  2.医生之前使用的是国内手机号可以收到短信，修改海外短信之后，很多短信就用不上了。</p>
<p><strong>大坑3.jwt第一次登录不行，第二次登录可以。</strong><br>是Java生成的JWT的开始时间大于dotnet校验JWT的当前服务器时间，所以就校验失败<br>日志：</p>
<p>  INFO  2020-03-05 16:11:06,995 [79] uthentication.JwtBearer.JwtBearerHandler - Failed to validate the token.<br>  Microsoft.IdentityModel.Tokens.SecurityTokenNotYetValidException: IDX10222: Lifetime validation failed. The token is not yet valid. ValidFrom: ‘03/05/2020 08:11:07’, Current time: ‘03/05/2020 08:11:06’.at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable<code>1 notBefore, Nullable</code>1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable<code>1 notBefore, Nullable</code>1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)</p>
<h1 id="0306"><a href="#0306" class="headerlink" title="0306"></a>0306</h1><h2 id="踩坑-1"><a href="#踩坑-1" class="headerlink" title="踩坑"></a>踩坑</h2><h3 id="1-textnow-不行，现在已经没那么容易薅羊毛了"><a href="#1-textnow-不行，现在已经没那么容易薅羊毛了" class="headerlink" title="1.textnow 不行，现在已经没那么容易薅羊毛了"></a>1.textnow 不行，现在已经没那么容易薅羊毛了</h3><p>用这个免费网站发就行：<a href="https://smsreceivefree.com/" target="_blank" rel="external">https://smsreceivefree.com/</a></p>
<h3 id="2-小坑：SMS国际短信阿里需要带上区号，不要-号"><a href="#2-小坑：SMS国际短信阿里需要带上区号，不要-号" class="headerlink" title="2.小坑：SMS国际短信阿里需要带上区号，不要+号"></a>2.小坑：SMS国际短信阿里需要带上区号，不要+号</h3><h3 id="3-Float的默认值是0-0f-并不是null"><a href="#3-Float的默认值是0-0f-并不是null" class="headerlink" title="3.Float的默认值是0.0f 并不是null"></a>3.Float的默认值是0.0f 并不是null</h3><p>现在的需求：希望0和null能区分开。0表示0分，而null表示不计分</p>
<p>数据库float值为null 接收的是0不是想要的答案<br><a href="https://zhidao.baidu.com/question/569047818.html" target="_blank" rel="external">https://zhidao.baidu.com/question/569047818.html</a><br>只能数据库使用String，修改MYSQL的字段类型。<br>DO使用String类型接收，DTO使用Float类型。如果DO是null,就给DTO置为null。</p>
<h2 id="Liquisbase使用"><a href="#Liquisbase使用" class="headerlink" title="Liquisbase使用"></a>Liquisbase使用</h2><p>终于使用liquibase回滚成功了，用了三天太慢了。不知道为什么代码里面回滚就是不行，似乎有点奇怪。<br>是在liquibase目录下成功的。在liquibase里面也有一个简单的example使用H2数据库这里使用mysql数据库了</p>
<h3 id="第1步：下载和解压Liquibase"><a href="#第1步：下载和解压Liquibase" class="headerlink" title="第1步：下载和解压Liquibase"></a>第1步：下载和解压Liquibase</h3><p>下载Liquibase，可以从该页面下载最新的二进制文件<br>下载好<em>.zip或者</em>.tar.gz文件后，解压里面的内容到一个文件夹。</p>
<h3 id="第2步：-安装Java"><a href="#第2步：-安装Java" class="headerlink" title="第2步： 安装Java"></a>第2步： 安装Java</h3><p>Java 是必需的依赖项。如果尚未安装 Java，则安装Java。</p>
<p>注意：您可以下载并使用 OpenJDK。请务必正确配置路径和环境变量。<br>验证您是否具有可以运行的 java 版本。</p>
<p>在命令行窗口执行java -version命令<br>确保它可以成功运行并且显示了你安装的Java的版本</p>
<h3 id="第3步：下载MYSQL-JDBC数据库驱动"><a href="#第3步：下载MYSQL-JDBC数据库驱动" class="headerlink" title="第3步：下载MYSQL JDBC数据库驱动"></a>第3步：下载MYSQL JDBC数据库驱动</h3><p>这些教程使用 Mysql 数据库。您需要下载 Mysql JDBC 驱动程序，可在此处找到。<br>将 Mysql_.jar文件复制到您解压Liquibase *zip 或 *.tar.gz的产生的目录中。</p>
<h3 id="第4步：-设置liquibase-properties文件"><a href="#第4步：-设置liquibase-properties文件" class="headerlink" title="第4步： 设置liquibase.properties文件"></a>第4步： 设置liquibase.properties文件</h3><p>driver: com.mysql.cj.jdbc.Driver<br>classpath: ./mysql-connector-java-8.0.16.jar<br>url: jdbc:mysql://localhost:3306/localtest?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai&amp;useColumnNamesInFindColumn=true<br>username: root<br>password: 123456<br>changeLogFile: myChangeLog.xml</p>
<h3 id="myChangeLog-xml"><a href="#myChangeLog-xml" class="headerlink" title="myChangeLog.xml"></a>myChangeLog.xml</h3><p>  &lt;?xml version=”1.0” encoding=”UTF-8”?&gt;<br>  <databasechangelog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemalocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd"><br>    <changeset author="authorName" id="changelog-1.0"><br>      <createtable tablename="testTable"><br>        <column name="COLUMN1" type="TEXT"><br>          <constraints nullable="true" primarykey="false" unique="false"><br>        </constraints></column><br>      </createtable></changeset></databasechangelog></p>
<pre><code>  &lt;rollback&gt;
      drop table testTable
  &lt;/rollback&gt;
&lt;/changeSet&gt;

&lt;changeSet author=&quot;authorName&quot; id=&quot;changelog-2.0&quot;&gt;
  &lt;createTable tableName=&quot;testTable2&quot;&gt;
    &lt;column name=&quot;COLUMN1&quot; type=&quot;TEXT&quot;&gt;
      &lt;constraints nullable=&quot;true&quot; primaryKey=&quot;false&quot; unique=&quot;false&quot;/&gt;
    &lt;/column&gt;
  &lt;/createTable&gt;
&lt;/changeSet&gt;
</code></pre><p>  </p>
<p>在目录下执行：<br>liquibase update 就会创建两个表<br>执行<br>liquibase rollbackCount 1 回滚一个changeSet</p>
<h1 id="按照-changeSet-次数回滚"><a href="#按照-changeSet-次数回滚" class="headerlink" title="按照 changeSet 次数回滚"></a>按照 changeSet 次数回滚</h1><p>  liquibase  –changeLogFile=”sqls/changeLogFiledevtest.postgresql.sql” rollbackCount 1</p>
<h1 id="按照标签回滚"><a href="#按照标签回滚" class="headerlink" title="按照标签回滚"></a>按照标签回滚</h1><p>  liquibase  –changeLogFile=”sqls/changeLogFiledevtest.postgresql.sql” rollback v1.0</p>
<p>看了很多文件，这个写的不错：<br><a href="https://www.cnblogs.com/sanri1993/p/12125280.html" target="_blank" rel="external">https://www.cnblogs.com/sanri1993/p/12125280.html</a></p>
<p>这个写的很详细<br><a href="https://blog.csdn.net/u012934325/article/details/100652805" target="_blank" rel="external">https://blog.csdn.net/u012934325/article/details/100652805</a></p>
<p>数据库版本控制还是使用指令会好一点，接下来再试一下如何再代码里面控制回滚(不可以，如果代码里面可以回滚思考一下肯定会有问题的)</p>
<p><strong>回滚ChangeSet<br>Liquibase 允许您自动或通过自定义回滚 SQL 撤消对数据库所做的更改。回滚支持在command_line、Ant和 Maven中可用。不搞了。并不能通过代码回滚</strong></p>

    </div>

    
    
    
        
      

      <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/05/03/0224-0228/" rel="next" title="0224-0228总结">
                  <i class="fa fa-chevron-left"></i> 0224-0228总结
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2020/05/03/0309-0313/" rel="prev" title="0309-0313总结">
                  0309-0313总结 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="comments"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0302"><span class="nav-number">1.</span> <span class="nav-text">0302</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0303"><span class="nav-number">2.</span> <span class="nav-text">0303</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-mysql-批量修改一个字段"><span class="nav-number">2.0.1.</span> <span class="nav-text">1.mysql 批量修改一个字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-数据库数据问题。"><span class="nav-number">2.0.2.</span> <span class="nav-text">2.数据库数据问题。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-xshell-连接redis"><span class="nav-number">2.0.3.</span> <span class="nav-text">3.xshell 连接redis</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-redis"><span class="nav-number">2.0.4.</span> <span class="nav-text">4.redis</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0304"><span class="nav-number">3.</span> <span class="nav-text">0304</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#idea问题"><span class="nav-number">3.1.</span> <span class="nav-text">idea问题:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库迁移"><span class="nav-number">3.2.</span> <span class="nav-text">数据库迁移</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#flyway-DataBaseMigration初体验"><span class="nav-number">3.2.1.</span> <span class="nav-text">flyway DataBaseMigration初体验</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#问题：配置了阿里云镜像还是从国外服务器下载"><span class="nav-number">3.2.2.</span> <span class="nav-text">问题：配置了阿里云镜像还是从国外服务器下载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flyway配置数据源mysql"><span class="nav-number">3.2.3.</span> <span class="nav-text">flyway配置数据源mysql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flyway发现注入有问题"><span class="nav-number">3.2.4.</span> <span class="nav-text">flyway发现注入有问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注意"><span class="nav-number">3.3.</span> <span class="nav-text">注意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Liquibase-batabaseMigration"><span class="nav-number">3.4.</span> <span class="nav-text">Liquibase batabaseMigration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#powerdesigner数据库设计软件"><span class="nav-number">3.5.</span> <span class="nav-text">powerdesigner数据库设计软件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BUG"><span class="nav-number">3.6.</span> <span class="nav-text">BUG</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0305"><span class="nav-number">4.</span> <span class="nav-text">0305</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-libphonenumber"><span class="nav-number">4.1.</span> <span class="nav-text">1.libphonenumber</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-电话区号表"><span class="nav-number">4.2.</span> <span class="nav-text">2.电话区号表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-idea在Terminal中使用maven指令"><span class="nav-number">4.3.</span> <span class="nav-text">3.idea在Terminal中使用maven指令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-jwt的密钥在Java里面加-0-0-0-0无效，凑够16位"><span class="nav-number">4.4.</span> <span class="nav-text">4.jwt的密钥在Java里面加/0/0/0/0无效，凑够16位</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#踩坑"><span class="nav-number">4.5.</span> <span class="nav-text">踩坑</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0306"><span class="nav-number">5.</span> <span class="nav-text">0306</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#踩坑-1"><span class="nav-number">5.1.</span> <span class="nav-text">踩坑</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-textnow-不行，现在已经没那么容易薅羊毛了"><span class="nav-number">5.1.1.</span> <span class="nav-text">1.textnow 不行，现在已经没那么容易薅羊毛了</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-小坑：SMS国际短信阿里需要带上区号，不要-号"><span class="nav-number">5.1.2.</span> <span class="nav-text">2.小坑：SMS国际短信阿里需要带上区号，不要+号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Float的默认值是0-0f-并不是null"><span class="nav-number">5.1.3.</span> <span class="nav-text">3.Float的默认值是0.0f 并不是null</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Liquisbase使用"><span class="nav-number">5.2.</span> <span class="nav-text">Liquisbase使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#第1步：下载和解压Liquibase"><span class="nav-number">5.2.1.</span> <span class="nav-text">第1步：下载和解压Liquibase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第2步：-安装Java"><span class="nav-number">5.2.2.</span> <span class="nav-text">第2步： 安装Java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第3步：下载MYSQL-JDBC数据库驱动"><span class="nav-number">5.2.3.</span> <span class="nav-text">第3步：下载MYSQL JDBC数据库驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第4步：-设置liquibase-properties文件"><span class="nav-number">5.2.4.</span> <span class="nav-text">第4步： 设置liquibase.properties文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#myChangeLog-xml"><span class="nav-number">5.2.5.</span> <span class="nav-text">myChangeLog.xml</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#按照-changeSet-次数回滚"><span class="nav-number">6.</span> <span class="nav-text">按照 changeSet 次数回滚</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#按照标签回滚"><span class="nav-number">7.</span> <span class="nav-text">按照标签回滚</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/head.jpeg"
      alt="王邸">
  <p class="site-author-name" itemprop="name">王邸</p>
  <div class="site-description" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">55</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span>
        
      </div>
    
  </nav>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">王邸</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.3.8</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>



  





















  

  

  


<script>
NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'Fn4BuvoixOxjJAhR79TvaD5M-gzGzoHsz',
    appKey: '1uspTrSwPqkmSBSUr948WqxE',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: true,
    lang: '' || 'zh-cn',
    path: location.pathname
  });
}, window.Valine);
</script>

</body>
</html>
